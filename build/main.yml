pool:
  vmImage: 'windows-latest'

stages:
  - stage: build
    displayName: Build Code
    jobs:
      - job: buildDatabase
        displayName: Build buildDatabase
        steps:
          - task: MSBuild@1
            displayName: Build databases project
            inputs:
              configuration: release
              solution: src\db\DbaInventory\DbaInventory.sqlproj
              msbuildArguments: /p:"NetCoreBuild=true"
          - task: PowerShell@2
            inputs:
              targetType: inline
              script: get-childitem -path $(System.DefaultWorkingDirectory) -recurse
          - task: PublishPipelineArtifact@1
            inputs:
              targetPath: $(System.DefaultWorkingDirectory)/**/*.dacpac
              artifactName: drop